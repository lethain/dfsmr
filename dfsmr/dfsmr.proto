syntax = "proto3";

service DistributedFSMRunner {
	rpc Define (DefineRequest) returns (DefineReply) {}
	rpc Start (StartRequest) returns (AckReply) {}
	rpc Changes (ChangesRequest) returns (stream ChangesReply) {}
	rpc Machines (MachinesRequest) returns (MachinesReply) {}
	// rpc Instances (InstancesRequest) returns (InstancesReply) {}
	//rpc Transition (TransitionRequest) returns (TransitionReply) {}
	//rpc Relinquish (RelinquishRequest) returns (RelinquishReply) {}
	//rpc Ready (ReadyRequest) returns (ReadyReply) {}
}

message Transition {
	string node = 1;
	string name = 2;
}

message Node {
	string name = 1;
	repeated Transition transitions = 2;
}

message DefineRequest {
	string name = 1;
	repeated Node nodes = 2;
}


message DefineReply {
	bool success = 1;
	string name = 2;
	string successMessage = 3;	
	string errorMessage = 4;
}

message MachinesRequest {

}

message MachinesReply {
	repeated DefineRequest machines = 1;
}


message StartRequest {
	string name = 1;
}

message AckReply {
	bool success = 1;
	string successMessage = 2;
	string errorMessage = 3;
}

message ChangesRequest {

}

message ChangesReply {
	string command = 1;
	string client = 2;
}

